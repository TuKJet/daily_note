# Python 计算器使用说明

## 📖 简介

这是一个功能齐全的 Python 命令行计算器，支持基本运算、高级数学函数、括号优先级计算、连续计算和历史记录功能。

## 🚀 运行方式

```bash
python calculator.py
```

或者添加执行权限后直接运行：
```bash
chmod +x calculator.py
./calculator.py
```

## ✨ 功能特性

### 1. 基本运算
- ✅ 加法：`+`
- ✅ 减法：`-`
- ✅ 乘法：`*`
- ✅ 除法：`/`
- ✅ 取模：`%`
- ✅ 幂运算：`**`

### 2. 高级运算
- ✅ 开方：`sqrt(x)` 或 `x**0.5`
- ✅ 三角函数：`sin(x)`, `cos(x)`, `tan(x)`
- ✅ 对数函数：`log(x)` (自然对数), `log10(x)` (常用对数)
- ✅ 数学常量：`pi`, `e`

### 3. 括号优先级
- ✅ 完全支持括号 `()` 优先级计算
- ✅ 例如：`(2 + 3) * 4` 正确计算为 20

### 4. 交互功能
- ✅ 连续计算（无需重启）
- ✅ 历史记录查看
- ✅ 历史记录清除
- ✅ 友好的用户界面

### 5. 错误处理
- ✅ 除零错误处理
- ✅ 非法输入检测
- ✅ 数学域错误（如负数开平方）
- ✅ 语法错误提示

## 📝 使用示例

### 基本运算
```
>>> 2 + 3
✅ 计算结果：2 + 3 = 5

>>> 10 - 4
✅ 计算结果：10 - 4 = 6

>>> 6 * 7
✅ 计算结果：6 * 7 = 42

>>> 15 / 3
✅ 计算结果：15 / 3 = 5

>>> 17 % 5
✅ 计算结果：17 % 5 = 2

>>> 2 ** 8
✅ 计算结果：2 ** 8 = 256
```

### 高级运算
```
>>> sqrt(16)
✅ 计算结果：sqrt(16) = 4

>>> sin(pi/2)
✅ 计算结果：sin(pi/2) = 1

>>> cos(0)
✅ 计算结果：cos(0) = 1

>>> log(e)
✅ 计算结果：log(e) = 1

>>> log10(100)
✅ 计算结果：log10(100) = 2
```

### 复杂表达式
```
>>> (2 + 3) * 4
✅ 计算结果：(2 + 3) * 4 = 20

>>> sqrt(16) + sin(pi/2)
✅ 计算结果：sqrt(16) + sin(pi/2) = 5

>>> log(100) / log(10)
✅ 计算结果：log(100) / log(10) = 2
```

### 历史记录
```
>>> history
📊 完整计算历史记录
============================================================
  1. 2 + 3 = 5
  2. sqrt(16) = 4
  3. log10(100) = 2
============================================================

>>> clear
✅ 历史记录已清除
```

## 🎯 命令说明

| 命令 | 功能 |
|------|------|
| `quit` | 退出程序 |
| `exit` | 退出程序 |
| `history` | 查看完整计算历史 |
| `clear` | 清除历史记录 |

## ⚠️ 错误处理示例

### 除零错误
```
>>> 10 / 0
❌ 错误：除零错误
```

### 非法输入
```
>>> 2 +
❌ 错误：语法错误，请检查输入
```

### 数学域错误
```
>>> sqrt(-1)
❌ 错误：数学域错误（如负数开平方）

>>> log(0)
❌ 错误：数学域错误（如负数开平方）
```

## 🔧 技术实现

- **语言**：Python 3
- **标准库**：math, re
- **安全特性**：
  - 禁用内置函数执行
  - 白名单字符验证
  - 独立的数学计算环境

## 📊 测试

运行测试脚本：
```bash
python test_calculator.py          # 基础功能测试
python comprehensive_test.py       # 综合测试（包括错误处理）
```

## 🎉 验收标准

✅ **能正确执行各类数学运算**
- 基本运算：加减乘除、取模、幂运算
- 高级运算：开方、三角函数、对数
- 复杂表达式：支持括号优先级

✅ **界面友好，交互流畅**
- 清晰的欢迎界面
- 友好的提示信息
- 连续计算支持

✅ **错误处理完善**
- 除零错误
- 语法错误
- 非法输入
- 数学域错误

✅ **代码可读性强**
- 清晰的函数封装
- 详细的注释说明
- 模块化设计

## 📝 更新日志

### v1.0 (2026-01-13)
- ✅ 实现基本运算功能
- ✅ 实现高级运算功能
- ✅ 实现括号优先级计算
- ✅ 添加交互界面
- ✅ 添加历史记录功能
- ✅ 完善错误处理
- ✅ 通过全部测试用例

## 📄 许可证

本项目使用 MIT 许可证。